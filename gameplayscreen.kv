# All classes related to the game play screen

<CardToggle>:
    background_normal: root.card.normalimage() if root.card else ''   
    background_down: root.card.downimage() if root.card else ''   
    canvas.before:
        PushMatrix
        Rotate:
            angle: self.angle
            origin: self.center
    canvas.after:
        PopMatrix

<SelectPlayersPopup@Popup>:
    size_hint: 1, 1
    separator_height: 0
    title: 'Who found the collection?'


<GamePlayScreen@Screen>:
    id: mainpage
    name: 'screen2'
    canvas.before:
        Color:
            rgba: 173/255. , 255/255., 47/255., 0.8
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            orientation: "horizontal"
            Label:
                id: label_p1
                size_hint: .1, .1
                color: 0, 0, 0, 1
                text: root.name_of_players[0] + ': '+ str(root.scores_of_players[0]) if root.number_of_players >= 1 else ''
                #pos: [root.width-label_p2.x-label_p2.width, root.height-self.height] if root.number_of_players > 1 else [self.width/2., root.height-self.height]
                #halign: 'center' 
            BoxLayout:
                orientation: "vertical"           
                Label:
                    id: label_numCollections
                    size_hint: .1, .1
                    color: 0, 0, 0, 1        
                    text: str(Deck.numberOfSets(root.cards)) + " collections on the board" 
                    #halign: 'center'
                    #size: 100,100
                    #size_hint_y: None
                    #height: self.texture_size[1] + dp(10)           
                    #pos: label_ai.pos[0], label_ai.pos[1]-self.height/6.            
                Label:
                    id: label_ai
                    size_hint: .1, .1
                    color: 0, 0, 0, 1        
                    text: "AI: " + str(root.aiScore) if root.aiActivated else ""
                    #pos: (root.width-self.width)/2., root.height-self.height
                    halign: 'center'
            Label:
                id: label_p2
                size_hint: .1, .1
                color: 0, 0, 0, 1        
                text: root.name_of_players[1] + ': '+ str(root.scores_of_players[1]) if root.number_of_players >= 2 else ''
                pos: root.width-self.width, label_p1.y
                halign: 'center'   
        GridLayout:

            id: cards_layout
            cols: 3
            size_hint_y: 3
            spacing: '10dp'
            #pos: (root.width-self.width)/2., settingsButton.size[1]+10
            halign: 'center'
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:
            CardToggle:

        BoxLayout:
            Label:
                id: label_p3
                size_hint: .1, .1
                color: 0, 0, 0, 1        
                text: root.name_of_players[2] + ': '+ str(root.scores_of_players[2]) if root.number_of_players >= 3 else ''
                pos: label_p1.x, self.height/2.
                halign: 'center'
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: ""
                Button:
                    id: settingsButton
                    text: 'Settings'
                    background_color: 102/255., 102/255., 0/255., 0.8
                    size: 200, 80
                    pos: (root.width-self.width)/2., 0
                    size_hint: (None, None)
                    on_press:
                        root.stopClocks()
                        app.open_settings()
            Label:
                id: label_p4    
                size_hint: .1, .1
                color: 0, 0, 0, 1
                text: root.name_of_players[3] + ': '+ str(root.scores_of_players[3]) if root.number_of_players >= 4 else ''
                pos: label_p2.x, label_p3.y
                halign: 'center'